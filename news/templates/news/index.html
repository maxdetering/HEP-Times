{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The HEP Times</title>
    <!-- Google Fonts for that Newspaper feel -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=UnifrakturMaguntia&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'news/style.css' %}">
    <link rel="stylesheet" href="{% static 'news/pagination.css' %}">

    <!-- MathJax Configuration -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <!-- Old german style font for the logo could be cool, using Playfair for now from CSS -->
            <h1 class="title">The HEP Times</h1>
            <div class="meta-header">
                <span>Vol. {{ today|date:"Y" }} No. {{ today|date:"z" }}</span>
                <span>{{ today|date:"l, F j, Y" }}</span>
                <span>Price: Free (Open Access)</span>
            </div>
        </header>

        <main>
            {% if current_page > 1 %}
            <div class="section-header">
                <h2 class="section-title">{{ page_title }}</h2>
            </div>
            {% endif %}

            {% if headline_paper %}
            <article class="headline-section">
                <span class="category-tag">{{ headline_paper.primary_category }}</span>
                <h2 class="headline-title">{{ headline_paper.title|safe }}</h2>
                <div class="headline-meta">By {{ headline_paper.authors_str }}</div>
                <div class="headline-abstract">
                    <p><b>{{ headline_paper.published|date:"M d, Y" }}</b> â€” {{ headline_paper.abstract|safe|truncatewords:150 }}</p>
                </div>
                <br>
                <a href="{{ headline_paper.pdf_link }}" target="_blank" class="read-more">Read Full Paper (PDF)</a>
            </article>
            {% else %}
            <p style="text-align: center;">No papers found. Is ArXiv down or are there no new submissions?</p>
            {% endif %}

            <div class="grid-container">
                {% for paper in other_papers %}
                <article class="paper-card">
                    <span class="category-tag">{{ paper.primary_category }}</span>
                    <h3 class="paper-title">{{ paper.title|safe }}</h3>
                    <div class="paper-authors">By {{ paper.authors|slice:":3"|join:", " }}{% if paper.authors|length > 3 %}, et al.{% endif %}</div>
                    <p class="paper-abstract">{{ paper.abstract|safe|truncatewords:50 }}</p>
                    <a href="{{ paper.link }}" target="_blank" style="color: black; text-decoration: underline;">ArXiv Link</a> | 
                    <a href="{{ paper.pdf_link }}" target="_blank" style="color: #8b0000; font-weight: bold;">PDF</a>
                </article>
                {% endfor %}
            </div>

            <div class="pagination">
                {% for p in page_links %}
                    {% if p == current_page %}
                        <span class="current-page">{{ p }}</span>
                    {% else %}
                        <a href="{% url 'index_paginated' p %}">{{ p }}</a>
                    {% endif %}
                {% endfor %}
            </div>
        </main>

        <footer>
            <p>Generated by The HEP Times Engine &bull; Data provided by ArXiv API</p>
        </footer>
    </div>
</body>
</html>
